"use strict";var d=Object.create;var a=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var T=(e,t)=>{for(var n in t)a(e,n,{get:t[n],enumerable:!0})},c=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of v(t))!y.call(e,r)&&r!==n&&a(e,r,{get:()=>t[r],enumerable:!(o=h(t,r))||o.enumerable});return e};var m=(e,t,n)=>(n=e!=null?d(f(e)):{},c(t||!e||!e.__esModule?a(n,"default",{value:e,enumerable:!0}):n,e)),x=e=>c(a({},"__esModule",{value:!0}),e);var F={};T(F,{default:()=>u});module.exports=x(F);var p=m(require("crypto")),l=m(require("child_process")),i=(e=Date.now().toString())=>{let t=p.default.createHash("sha256");return t.update(e),t.digest("hex").slice(0,8)},H=()=>l.default.execSync("git rev-parse HEAD").toString().trim().slice(0,8),P=()=>process.env.npm_package_version||"0.0.0",D=(e,t)=>{switch(e){case"random":return i(t);case"git":return H();case"package":return P();case"custom":return t||i();default:return i()}};function u(e){let t=e.name||"version",n=e.from||"random",o=e.timeCell||1e3*60*60,r=e.plainText||Date.now().toString(),g=D(n,r);return{name:"vite-plugin-version-updater",apply:"build",enforce:"pre",transformIndexHtml(){let s=[];return s.push({tag:"meta",attrs:{name:t,content:g}}),s.push({tag:"script",attrs:{type:"text/javascript"},children:`
        "use strict";(()=>{var a=/(<meta name="${t||"version"}" content=")([^"]*)(">)/,s=()=>{let e=new XMLHttpRequest;e.open("GET",location.href),e.send(),e.onload=t=>{let n=t.target.response.match(a)?.[2],o=document.querySelector('meta[name="${t||"version"}"]').content;n!==o&&location.reload()}},c=function(){setInterval(s,${o})}();})();
        `,injectTo:"body"}),s}}}
