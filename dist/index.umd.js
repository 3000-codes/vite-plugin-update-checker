(function(r,n){typeof exports=="object"&&typeof module<"u"?module.exports=n():typeof define=="function"&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self,r["version-updater"]=n())})(this,function(){"use strict";const r={},n=(e=Date.now().toString())=>{const t=r.createHash("sha256");return t.update(e),t.digest("hex").slice(0,8)},o=()=>r.execSync("git rev-parse HEAD").toString().trim().slice(0,8),a=()=>process.env.npm_package_version||"0.0.0",c=(e,t)=>{switch(e){case"random":return n(t);case"git":return o();case"package":return a();case"custom":return t||n();default:return n()}};function i(e={}){const t=e.name||"version",u=e.from||"random",d=e.timeCell||1e3*60*60,m=e.plainText||Date.now().toString(),l=c(u,m);return{name:"vite-plugin-version-updater",apply:"build",enforce:"pre",transformIndexHtml(){const s=[];return s.push({tag:"meta",attrs:{name:t,content:l}}),s.push({tag:"script",attrs:{type:"text/javascript"},children:`
        "use strict";(()=>{var a=/(<meta name="${t||"version"}" content=")([^"]*)(">)/,s=()=>{let e=new XMLHttpRequest;e.open("GET",location.href),e.send(),e.onload=t=>{let n=t.target.response.match(a)?.[2],o=document.querySelector('meta[name="${t||"version"}"]').content;n!==o&&location.reload()}},c=function(){s(),setInterval(s,${d})}();})();
        `,injectTo:"body"}),s}}}return i});
